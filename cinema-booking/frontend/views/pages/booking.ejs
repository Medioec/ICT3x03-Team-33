<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- nts. replace with MovieDetails title -->
    <title>Seat Selection for <%= showtimeDetails.movieTitle %></title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css"/>

    <link rel="stylesheet" href="/css/nav.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/booking.css" />
</head>

<body>
    <div id="modalOverlay" class="overlay"></div>
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="flex-row" id="modalCloseRow">
                <button type="button" id="modalCloseBtn" class="btn-close" aria-label="Close"></button>
            </div>
            <div class="flex-row" id="modalRow">
                <h2 class="showcaseHeading">Login Required</h2>
            </div>
            <div class="row" id="modalRow">
                <h3 class="loginWarning">You need to be logged in to purchase a ticket.</p>
            </div>
            <div class="row" id="modalRow">
                <div class="col-auto">
                    <button id="cancelButton" class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
                <div class="col-auto">
                    <a class="btn btn-primary" href="/login" role="button">Login</a>
                </div>
            </div>
        </div>
    </div>  
    <!-- Navbar -->
    <%- include('../partial/navbar.ejs', { loggedIn: loggedIn }) %>

    <div class="container">
        <div class="row">
            <div class="col-md-3" id="showcaseContainer">
                <div class="showcase-box">
                    <img src="/images/movies/<%= showtimeDetails.movieTitle.replace(/[:\s]/g, '_') %>.jpg"
                    onerror="this.onerror=null; this.src='/images/movies/placeholder.jpg';"
                    alt="poster" /></a>                </div>
                <h1 id="movieTitle"> <%= showtimeDetails.movieTitle %></h1>
            </div>
            <div class="col-md-9">
                <div class="flex-row" id="showtimeRow2">
                    <div class="p-2">
                        <div class="button-container">
                            <div class="row" id="dropdownHeader">Cinema:</div>
                            <div class="row">
                                <div class="dropdown">
                                    <button id="cinemaDropdown" class="btn btn-secondary dropdown-toggle" type="button"
                                        data-bs-toggle="dropdown">
                                        <%= showtimeDetails.cinemaName %>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#">GV Bugis</a></li>
                                        <li><a class="dropdown-item" href="#">Shaw Paya Lebar</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-2">
                        <!-- nts. showtimes date -->
                        <div class="button-container">
                            <div class="row" id="dropdownHeader">Date:</div>
                            <div class="row">
                                <div class="dropdown">
                                    <button id="dateDropdown" class="btn btn-secondary dropdown-toggle" type="button"
                                        data-bs-toggle="dropdown">
                                        <%= showtimeDetails.showDate %>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#">MONDAY 23-10-23</a></li>
                                        <li><a class="dropdown-item" href="#">TUESDAY 24-10-23</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-2">
                        <!-- nts. showtimes time -->
                        <div class="button-container">
                            <div class="row" id="dropdownHeader">Time:</div>
                            <div class="row">
                                <div class="dropdown">
                                    <button id="movieDropdown" class="btn btn-secondary dropdown-toggle" type="button"
                                        data-bs-toggle="dropdown">
                                        <%= showtimeDetails.showTime %>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="#">12:00PM</a></li>
                                        <li><a class="dropdown-item" href="#">1:45PM</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="p-2" id="seatingPlanCol">
                        <button id="location" class="btn btn-primary">
                            View Seating Plan
                        </button>
                    </div>
                </div>

                <!-- seat selection here -->
                <ul class="showcase">
                    <li>
                        <div class="seat display" id="showcaseSeats"></div>
                        <small>Available</small>
                    </li>
                    <li>
                        <div class="seat-reserved" id="reserved"></div>
                        <small>Selected</small>
                    </li>
                    <li>
                        <div class="seat sold"></div>
                        <small>Sold</small>
                    </li>
                </ul>
                <div class="seatContainer">
                    <div class="screen" id="seatingPlanScreen">
                        <a>
                            Screen
                        </a>
                    </div>
                    <div class="row">
                        <div class="seatNumbers">A</div>
                        <div class="seat" id="A1"></div>
                        <div class="seat" id="A2"></div>
                        <div class="seat" id="A3"></div>
                        <div class="seat" id="A4"></div>
                        <div class="seat" id="A5"></div>
                        <div class="seat" id="A6"></div>
                        <div class="seat" id="A7"></div>
                        <div class="seat" id="A8"></div>
                    </div>
                    
                    <div class="row">
                        <div class="seatNumbers">B</div>
                        <div class="seat" id="B1"></div>
                        <div class="seat" id="B2"></div>
                        <div class="seat" id="B3"></div>
                        <div class="seat sold" id="B4"></div>
                        <div class="seat sold" id="B5"></div>
                        <div class="seat" id="B6"></div>
                        <div class="seat" id="B7"></div>
                        <div class="seat" id="B8"></div>
                    </div>
                    <div class="row">
                        <div class="seatNumbers">C</div>
                        <div class="seat" id="C1"></div>
                        <div class="seat" id="C2"></div>
                        <div class="seat" id="C3"></div>
                        <div class="seat" id="C4"></div>
                        <div class="seat" id="C5"></div>
                        <div class="seat" id="C6"></div>
                        <div class="seat sold" id="C7"></div>
                        <div class="seat sold" id="C8"></div>
                    </div>
                    
                    <div class="row">
                        <div class="seatNumbers">D</div>
                        <div class="seat" id="D1"></div>
                        <div class="seat" id="D2"></div>
                        <div class="seat" id="D3"></div>
                        <div class="seat" id="D4"></div>
                        <div class="seat" id="D5"></div>
                        <div class="seat" id="D6"></div>
                        <div class="seat" id="D7"></div>
                        <div class="seat" id="D8"></div>
                    </div>
                    
                    <div class="row">
                        <div class="seatNumbers">E</div>
                        <div class="seat" id="E1"></div>
                        <div class="seat" id="E2"></div>
                        <div class="seat" id="E3"></div>
                        <div class="seat" id="E4"></div>
                        <div class="seat" id="E5"></div>
                        <div class="seat" id="E6"></div>
                        <div class="seat sold" id="E7"></div>
                        <div class="seat sold" id="E8"></div>
                    </div>
                    
                    <div class="row">
                        <div class="seatNumbers">F</div>
                        <div class="seat" id="F1"></div>
                        <div class="seat" id="F2"></div>
                        <div class="seat" id="F3"></div>
                        <div class="seat" id="F4"></div>
                        <div class="seat" id="F5"></div>
                        <div class="seat sold" id="F6"></div>
                        <div class="seat sold" id="F7"></div>
                        <div class="seat sold" id="F8"></div>
                    </div>
                    
                    <div class="row">
                        <div class="seatNumbers" id="seatingPlanSeat">1</div>
                        <div class="seatNumbers">2</div>
                        <div class="seatNumbers">3</div>
                        <div class="seatNumbers">4</div>
                        <div class="seatNumbers">5</div>
                        <div class="seatNumbers">6</div>
                        <div class="seatNumbers">7</div>
                        <div class="seatNumbers">8</div>
                    </div>
                    
                </div>
            </div>
            <div class="booking-selection">
                <div class="row ticketRow">
                    <div class="col-md-4">
                        <a class="ticketHeaders">TICKET TYPE</a>
                    </div>
                    <div class="col-md-4">
                        <a class="ticketHeaders">SEATS SELECTED</a>
                    </div>
                    <div class="col-md-2">
                        <a class="ticketHeaders">TICKET PRICE</a>
                    </div>
                    <div class="col-md-2">
                        <a class="ticketHeaders">QUANTITY</a>
                    </div>
                </div>
                <div class="row ticketRow">
                    <div class="col-md-4">
                        Adult
                    </div>
                    <div class="col-md-4" id="selectedSeatsDisplay">
                        <!-- array of seats selected will appear here -->
                        None
                    </div>
                    <div class="col-md-2">
                        $10.50
                    </div>
                    <div class="col-md-2">
                        <p class="text">
                            <span id="count">0</span>
                        </p>
                    </div>
                </div>
                <div class="row" id="ticketRow">
                    <div class="col-md-2">
                        <a class="ticketHeaders">TOTAL PRICE</a>
                    </div>
                    <div class="col-md-2" id="priceRow">
                        <h4 class="totalPrice">$</h4><h4 class="totalPrice" id="total">0</h4>
                    </div>
                </div>
                <div class="row" id="ticketRow">
                    <div class="col-md-2">
                        <button id="resetButton" class="btn btn-secondary">
                            RESET
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button id="checkoutButton" class="btn btn-primary" data-loggedin="<%= loggedIn %>">
                            CHECKOUT
                        </button>
                    </div>
                </div>
            </div>      
        </div>
    </div>

    </div>
    </div>
    </div>
    
    <!-- footer -->
    <%- include('../partial/footer'); %>

    <script>  
        window.showtimeDetails = <%- JSON.stringify(showtimeDetails) %>;
    </script>
    <script src="/js/booking.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.min.js"></script>
</body>

</html>